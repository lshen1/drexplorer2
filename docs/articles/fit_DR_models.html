<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fit Dose-Response Models â€¢ drexplorer2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Fit Dose-Response Models">
<meta property="og:description" content="drexplorer2">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">drexplorer2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/ALL.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lshen1/drexplorer2/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fit Dose-Response Models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lshen1/drexplorer2/blob/master/vignettes/fit_DR_models.Rmd"><code>vignettes/fit_DR_models.Rmd</code></a></small>
      <div class="hidden name"><code>fit_DR_models.Rmd</code></div>

    </div>

    
    
<p>Below we show how to fit a dose-response model. The <code><a href="../reference/drFit.html">drFit()</a></code> function is a wrapper to the <strong>drc</strong> and <strong>DoseFinding</strong> packages. Therefore, all models implemented by either package can be fitted. A model is specified by a <em>modelName</em> to be passed to this function.</p>
<p>Outliers can be identified and removed from model fitting by specifying the parameter alpha (either at significance level of 0.01 or 0.05). To disable outlier identification, set <em>alpha=1</em>.</p>
<p>To remove controls (responses at dose=0) during model fitting, we can set <em>fitCtr=FALSE</em>.</p>
<p>Note that the responses are scaled by mean response at dose=0 before model fitting.</p>
<p>Below we fit a sigmaEmax model. We set <em>alpha=1</em> to disable outlier removal and <em>fitCtr=FALSE</em> to exclude controls.</p>
<html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">drexplorer2</span>)

<span class="no">fit_sigEmax_alpha1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/drFit.html">drFit</a></span>(<span class="kw">drMat</span> <span class="kw">=</span> <span class="no">ryegrass</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">1</span>)],
                            <span class="kw">modelName</span> <span class="kw">=</span> <span class="st">"sigEmax"</span>,
                            <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">fitCtr</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html>
<p>The result is slightly different when outliers passing significance level of 0.05 is removed.</p>
<html><body><pre class="r"><span class="no">fit_sigEmax_alpha_o5</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/drFit.html">drFit</a></span>(<span class="kw">drMat</span> <span class="kw">=</span> <span class="no">ryegrass</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">1</span>)],
                              <span class="kw">modelName</span> <span class="kw">=</span> <span class="st">"sigEmax"</span>,
                              <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.05</span>, <span class="kw">fitCtr</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">fit_sigEmax_alpha1</span>@<span class="kw">fit</span>
<span class="co">#&gt; Dose Response Model</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: sigEmax </span>
<span class="co">#&gt; Fit-type: normal </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients dose-response model</span>
<span class="co">#&gt;    e0  eMax  ed50     h </span>
<span class="co">#&gt;  1.03 -0.97  2.99  2.81 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Degrees of freedom: 14 </span>
<span class="co">#&gt; Residual standard error: 0.073</span>
<span class="no">fit_sigEmax_alpha_o5</span>@<span class="kw">fit</span>
<span class="co">#&gt; Dose Response Model</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: sigEmax </span>
<span class="co">#&gt; Fit-type: normal </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients dose-response model</span>
<span class="co">#&gt;     e0   eMax   ed50      h </span>
<span class="co">#&gt;  1.017 -0.945  2.789  3.384 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Degrees of freedom: 13 </span>
<span class="co">#&gt; Residual standard error: 0.0567</span></pre></body></html>
<div id="predict-response" class="section level2">
<h2 class="hasAnchor">
<a href="#predict-response" class="anchor"></a>Predict response</h2>
<p>One a model is fitted, it can be used to make predictions.</p>
<p>Below we make predictions at the observed dose levels with a previously fitted model. Since the responses are scaled by mean response at dose=0 in model fitting, the predicted responses are also scaled by the mean response from controls. By default, the predict function makes predictions at observed doses.</p>
<html><body><pre class="r"><span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/predict-methods.html">predict</a></span>(<span class="no">fit_sigEmax_alpha_o5</span>)
<span class="no">y</span>
<span class="co">#&gt;      1      2      3      4      5      6      7      8      9     10     11 </span>
<span class="co">#&gt; 1.0174 1.0174 1.0174 1.0174 1.0174 1.0174 0.9942 0.9942 0.9942 0.8205 0.8205 </span>
<span class="co">#&gt;     12     13     14     15     16     17     18     19     20     21     22 </span>
<span class="co">#&gt; 0.8205 0.3262 0.3262 0.3262 0.1045 0.1045 0.1045 0.0756 0.0756 0.0756 0.0727 </span>
<span class="co">#&gt;     23     24 </span>
<span class="co">#&gt; 0.0727 0.0727</span></pre></body></html>
</div>
<div id="obtain-ic-values" class="section level2">
<h2 class="hasAnchor">
<a href="#obtain-ic-values" class="anchor"></a>Obtain IC values</h2>
<p>We implement two approaches for IC value computation. One is to interpolate the observed dosages and try to use the dose that has the predicted response closest to the specified percentile of IC value.</p>
<p>The second approach is to use root finding by setting the fitted model to equal to the specified percentile. In most cases, the result are similar. However, the latter approach may give IC50 values beyond observed dosages and sometimes not robust. Further, a specified IC might be not achievable for the fitted model, in which case the returned dose is either -Inf (a flagger for percentile being too small to be achieved) or Inf (a flagger for percentile being too large to be achieved). The <code><a href="../reference/computeIC.html">computeIC()</a></code> function implements both approaches. By setting <em>interpolation=TRUE</em> (the default value) in the <code><a href="../reference/computeIC.html">computeIC()</a></code> function, the interpolation approach will be selected.</p>
<p>Computing IC values at different quantiles is also easy. Similar to the <code><a href="../reference/drFit.html">drFit()</a></code> function, different models as well as other options (alpha and fitCtr) can be specified in estimating IC value.</p>
<p>Below we estimate IC50 at different percentiles with the sigmoid Emax model with outlier removal (alpha=0.05) fitted previously. We see that estimates from interpolation and prediction (may be extrapolated) by the model are quite similar except for IC0 and IC100. IC100 from prediction is Inf since the fitted model cannot achieve 100% killing effect (see figure below). IC100 from interpolation is the maximum dose (30 in this case) which is a truncated estimate.</p>
<p>Similarly, since IC0 is not achievable within the observed dose, the prediction estimate of 0.86 is smaller than the minimum dose (0.94). The predicted IC value has advantage over interpolated IC value in the sense that it is not truncated. However, since the value might be extrapolated (estimate being outside of observed dose range), the estimate is more variable.</p>
<html><body><pre class="r"><span class="fu"><a href="../reference/computeIC.html">computeIC</a></span>(<span class="no">fit_sigEmax_alpha_o5</span>, <span class="kw">percent</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="kw">by</span><span class="kw">=</span><span class="fl">0.1</span>), <span class="kw">log.d</span><span class="kw">=</span><span class="fl">FALSE</span>, <span class="kw">interpolation</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="co">#&gt;   IC0  IC10  IC20  IC30  IC40  IC50  IC60  IC70  IC80  IC90 IC100 </span>
<span class="co">#&gt;  0.94  1.57  1.95  2.28  2.60  2.95  3.36  3.91  4.82  7.86 30.00</span>
<span class="fu"><a href="../reference/computeIC.html">computeIC</a></span>(<span class="no">fit_sigEmax_alpha_o5</span>, <span class="kw">percent</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="kw">by</span><span class="kw">=</span><span class="fl">0.1</span>), <span class="kw">log.d</span><span class="kw">=</span><span class="fl">FALSE</span>, <span class="kw">interpolation</span><span class="kw">=</span><span class="fl">FALSE</span>)
<span class="co">#&gt;   IC0  IC10  IC20  IC30  IC40  IC50  IC60  IC70  IC80  IC90 IC100 </span>
<span class="co">#&gt; 0.862 1.566 1.952 2.280 2.603 2.951 3.364 3.916 4.829 7.857   Inf</span></pre></body></html>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Li Shen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'fbd8d79ed49f21fc9ca7b2cf601a3f5b',
    indexName: 'pkgdown',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
