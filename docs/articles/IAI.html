<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Drug Interaction Index • drexplorer2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Drug Interaction Index">
<meta property="og:description" content="drexplorer2">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">drexplorer2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/ALL.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lshen1/drexplorer2/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Drug Interaction Index</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lshen1/drexplorer2/blob/master/vignettes/IAI.Rmd"><code>vignettes/IAI.Rmd</code></a></small>
      <div class="hidden name"><code>IAI.Rmd</code></div>

    </div>

    
    
<p>Administering two drugs simultaneously might induce stronger effect than if administered separately. This is called synergism. Experiments to detect synergism (or antagonism which is the opposite) are usually in two forms.</p>
<p>One is the fixed ratio design (ray design) where the ratio of doses between two drugs is a constant. Another one is grid design which means all-possible combinations of drug doses are available.</p>
<p>Two papers have been published regarding to drug interaction index (IAI) by Lee et al, one in 2007 <a href="#lee2007interaction">Lee, J. J., Kong, M., Ayers, G. D., &amp; Lotan, R. (2007)</a> and one in 2009 <a href="#lee2009confidence">Lee, J. J., &amp; Kong, M. (2009)</a>. IAI=1 is the case for additive effect. IAI&gt;1 means antagonistic interaction while IAI&lt;1 means synergistic interaction. The Lee2007 paper described five methods to assess interaction: (1) Lowewe additivity model using interaction index (IAI) (2) Model of Greco et al 1990. This approach uses <span class="math">\(\alpha\)</span> as the metric and it can be related to IAI (3) Model of Machado and Robinson which uses a metric denoted as <span class="math">\(\eta\)</span> (4) Model of Plummer and Short which can also be linked to IAI through the parameter <span class="math">\(\beta_4\)</span> (5) Model of Carter et al that can be linked to IAI through the parameter <span class="math">\(\beta_{12}\)</span>. For more details of these models, please refer to <a href="#lee2007interaction">Lee, J. J., Kong, M., Ayers, G. D., &amp; Lotan, R. (2007)</a>.</p>
<p>The two papers by Lee et al discussed the fixed ratio design and the source code for doing this is incorporated into <strong>drexplorer2</strong>. To work on grid design, a fixed ratio from the data needs to be selected in order to apply their method. For example, the Lee2007 paper provided an example of grid design. A fixed ratio of 1 was specified in the paper. The specification of fixed ratio would affect the fitted median effect model (see definition in <a href="#lee2007interaction">Lee, J. J., Kong, M., Ayers, G. D., &amp; Lotan, R. (2007)</a>) for the drug mixture as well as estimation of IAI. As a result, IAI has a ratio dependent interpretation.</p>
<p>Below we load the UMSCC22B data from <a href="#lee2009confidence">Lee, J. J., &amp; Kong, M. (2009)</a>. This data has a fixed ratio design. The <code>fitIAI</code> function estimates IAI as well as its confidence interval after specifying dose1, dose2 and effect (between 0 and 1).</p>
<html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">drexplorer2</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">UMSCC22B</span>)

<span class="no">fit_fixedRay</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/fitIAI.html">fitIAI</a></span>(<span class="kw">d1</span> <span class="kw">=</span> <span class="no">UMSCC22B</span>[, <span class="fl">1</span>], <span class="kw">d2</span> <span class="kw">=</span> <span class="no">UMSCC22B</span>[, <span class="fl">2</span>], <span class="kw">e</span> <span class="kw">=</span> <span class="no">UMSCC22B</span>[, <span class="fl">3</span>],
                       <span class="kw">name1</span> <span class="kw">=</span> <span class="st">'SCH66336'</span>, <span class="kw">name2</span> <span class="kw">=</span> <span class="st">'4HPR'</span>)</pre></body></html>
<p>The <code>plotIAI</code> function is then used to generate different plots including IAI versus response, IAI versus dose (predicted dose for the drug mixture, see equation (6) in <a href="#lee2007interaction">Lee, J. J., Kong, M., Ayers, G. D., &amp; Lotan, R. (2007)</a>), median effect plot and dose response curves. We can also plot IAI versus response as well as IAI versus dose in one figure by specifying mode=‘both’.</p>
<p>The median effect equation <a href="#chou1984quantitative">Chou, T. C., &amp; Talalay, P. (1984)</a> is as following: <span class="math">\[E=\frac{(d/D_{m})^m}{1+(d/D_{m})^m}\]</span></p>
<p>Sometimes replicated viability assays are performed. In such case, it is useful to examine if the experiments are reproducible.</p>
<p>A good metric is the <strong>Concordance Correlation Coefficient (CCC)</strong> that captures both the location shift as well as scale shift between the replicates. The <code>plotCCC</code> function can be used to compute CCC and visualize the replicated data.</p>
<p>where E is the induced effect of a drug with dose d whose median effective dose is <span class="math">\(D_{m}\)</span> and <span class="math">\(m\)</span> is a slope parameter.</p>
<p>This equation can be arranged as: <span class="math">\[logit(E)=m(log d - log D_{m})\]</span></p>
<p>The median effect plot shows logit(E) versus log10 dose; The dose response curve shows E versus dose. Below we plot IAI against response. The 95% confidence interval of IAI is shown in dashed line. It can be seen that there is significant synergistic interaction at small relative viability value (&lt;0.5). Although the IAI suggests antagonistic interaction at high viability values, the confidence band shows this is not statistically significant.</p>
<html><body><pre class="r"><span class="co">## IAI versus response</span>
<span class="fu"><a href="../reference/plotIAI.html">plotIAI</a></span>(<span class="no">fit_fixedRay</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'IAI'</span>, <span class="kw">mode</span> <span class="kw">=</span> <span class="st">'response'</span>)</pre></body></html>
<p><img src="IAI_files/figure-html/unnamed-chunk-2-1.png" width="2400" style="display: block; margin: auto;"></p>
<p>Similarly, we can plot IAI against dose (the sum of dosages from two drugs). The following figure shows that there is significant synergism at high dosage.</p>
<html><body><pre class="r"><span class="co">## IAI versus dose</span>
<span class="fu"><a href="../reference/plotIAI.html">plotIAI</a></span>(<span class="no">fit_fixedRay</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'IAI'</span>, <span class="kw">mode</span> <span class="kw">=</span> <span class="st">'dose'</span>)</pre></body></html>
<p><img src="IAI_files/figure-html/unnamed-chunk-3-1.png" width="2400" style="display: block; margin: auto;"></p>
<p>The median effect plot is shown below.</p>
<html><body><pre class="r"><span class="co">## median effect</span>
<span class="fu"><a href="../reference/plotIAI.html">plotIAI</a></span>(<span class="no">fit_fixedRay</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'medianEffect'</span>)</pre></body></html>
<p><img src="IAI_files/figure-html/unnamed-chunk-4-1.png" width="4800" style="display: block; margin: auto;"></p>
<p>In <a href="#lee2007interaction">Lee, J. J., Kong, M., Ayers, G. D., &amp; Lotan, R. (2007)</a>, there is an example data (nl22B2) using grid design. Here we examine the estimate of IAI at different fixed ratios.</p>
<html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">nl22B2</span>)

<span class="no">fit_allPoss_1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/fitIAI.html">fitIAI</a></span>(<span class="kw">d1</span> <span class="kw">=</span> <span class="no">nl22B2</span>$<span class="no">schd</span>, <span class="kw">d2</span> <span class="kw">=</span> <span class="no">nl22B2</span>$<span class="no">hpr</span>, <span class="kw">e</span> <span class="kw">=</span> <span class="no">nl22B2</span>$<span class="no">y1</span>,
                        <span class="kw">name1</span> <span class="kw">=</span> <span class="st">'SCH66336'</span>, <span class="kw">name2</span> <span class="kw">=</span> <span class="st">'4HPR'</span>, <span class="kw">d2.d1.force</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="no">fit_allPoss_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/fitIAI.html">fitIAI</a></span>(<span class="kw">d1</span> <span class="kw">=</span> <span class="no">nl22B2</span>$<span class="no">schd</span>, <span class="kw">d2</span> <span class="kw">=</span> <span class="no">nl22B2</span>$<span class="no">hpr</span>, <span class="kw">e</span> <span class="kw">=</span> <span class="no">nl22B2</span>$<span class="no">y1</span>,
                        <span class="kw">name1</span> <span class="kw">=</span> <span class="st">'SCH66336'</span>, <span class="kw">name2</span> <span class="kw">=</span> <span class="st">'4HPR'</span>, <span class="kw">d2.d1.force</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html>
<p>From the median effect plot, we can find that there are 4 data points for drug mixtures at fixed ratio of 1 while only 2 data points are available at fixed ratio of 2.</p>
<html><body><pre class="r"><span class="fu"><a href="../reference/plotIAI.html">plotIAI</a></span>(<span class="no">fit_allPoss_1</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'medianEffect'</span>)</pre></body></html>
<p><img src="IAI_files/figure-html/unnamed-chunk-6-1.png" width="2400" style="display: block; margin: auto;"></p>
<html><body><pre class="r"><span class="fu"><a href="../reference/plotIAI.html">plotIAI</a></span>(<span class="no">fit_allPoss_2</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'medianEffect'</span>)</pre></body></html>
<p><img src="IAI_files/figure-html/unnamed-chunk-7-1.png" width="2400" style="display: block; margin: auto;"></p>
<p>Below we compare IAI estimated from the two scenarios.</p>
<html><body><pre class="r"><span class="fu"><a href="../reference/plotCCC.html">plotCCC</a></span>(<span class="no">fit_allPoss_1</span>$<span class="no">CI</span>$<span class="no">IAI</span>, <span class="no">fit_allPoss_2</span>$<span class="no">CI</span>$<span class="no">IAI</span>)</pre></body></html>
<p><img src="IAI_files/figure-html/unnamed-chunk-8-1.png" width="2400" style="display: block; margin: auto;"></p>
<pre><code>#&gt;     ccc s_shift l_shift  ccc_lo  ccc_hi      Cb    corr  mean_x  mean_y    sd_x 
#&gt;  0.9670  0.7872 -0.0996  0.9632  0.9704  0.9674  0.9996  2.0011  1.6774  3.6746 
#&gt;    sd_y 
#&gt;  2.8928</code></pre>
<div id="drug-interaction-index-with-model-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#drug-interaction-index-with-model-selection" class="anchor"></a>Drug Interaction Index With Model Selection</h2>
<p>The original Chou-Talalay interaction index approach uses median-effect equation to model drug combination data. This method assumes idealized log-linearity which usually does not hold on real data. Here built upon the drexplorer package which automatically selects the best model without constraining to log-linear model, we try to overcome this limitation by extending the interaction index approach to non-linear functions. Using the UMSCC22B data as an example below. We first fit the model and then plot the IAI estimates.</p>
<html><body><pre class="r"><span class="no">fitL_mod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/fitIAI_mod.html">fitIAI_mod</a></span>(<span class="kw">d1</span> <span class="kw">=</span> <span class="no">UMSCC22B</span>[, <span class="fl">1</span>], <span class="kw">d2</span> <span class="kw">=</span> <span class="no">UMSCC22B</span>[, <span class="fl">2</span>], <span class="kw">e</span> <span class="kw">=</span> <span class="no">UMSCC22B</span>[, <span class="fl">3</span>],
                       <span class="kw">name1</span> <span class="kw">=</span> <span class="st">'SCH66336'</span>, <span class="kw">name2</span> <span class="kw">=</span> <span class="st">'4HPR'</span>, <span class="kw">ratio</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="fu"><a href="../reference/plotIAI_mod.html">plotIAI_mod</a></span>(<span class="no">fitL_mod</span>, <span class="kw">mixtureDose</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'A+B'</span>))</pre></body></html>
<p><img src="IAI_files/figure-html/unnamed-chunk-9-1.png" width="4800" style="display: block; margin: auto;"></p>
<p>Compared to the original Chou-Talalay method, we now observed the dose-response curves fit better to the data and thus IAI estimates from this approach are more reliable. Since some response values are not achieved in the data, it is hard to extrapolate what dose would achieve those responses. This makes the estimation of IAI unavailable in some regions. Thus, this new approach is more conservative compared to the original Chou-Talalay method.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Li Shen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'fbd8d79ed49f21fc9ca7b2cf601a3f5b',
    indexName: 'pkgdown',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
